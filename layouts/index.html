{{- define "main" }}

{{- if site.Params.homeInfoParams }}
<article class="first-entry home-info">
  <header class="entry-header">
    <h1>{{ site.Params.homeInfoParams.Title | markdownify }}</h1>
  </header>
  <div class="entry-content">
    {{ site.Params.homeInfoParams.Content | markdownify }}
  </div>
  <footer class="entry-footer">
    {{ range site.Params.socialIcons -}}
    <a href="{{ .url }}" target="_blank" rel="noopener noreferrer me" title="{{ .name | title }}" class="social-icon">
      {{- if eq .name "github" }}
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
      </svg>
      {{- else if eq .name "linkedin" }}
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path>
        <rect x="2" y="9" width="4" height="12"></rect>
        <circle cx="4" cy="4" r="2"></circle>
      </svg>
      {{- else if eq .name "rss" }}
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M4 11a9 9 0 0 1 9 9"></path>
        <path d="M4 4a16 16 0 0 1 16 16"></path>
        <circle cx="5" cy="19" r="1"></circle>
      </svg>
      {{- else }}
      <span>{{ .name }}</span>
      {{- end }}
    </a>
    {{- end }}
  </footer>
</article>
{{- end }}

{{- $pages := where site.RegularPages "Type" "in" site.Params.mainSections }}
{{- if not site.Params.mainSections }}
{{- $pages = where site.RegularPages "Section" "!=" "" }}
{{- end }}

{{- $pages = $pages.ByDate.Reverse }}
{{- $pages = first 5 $pages }}

{{- if gt (len $pages) 0 }}
<header class="page-header">
  <h2>Recent Posts</h2>
</header>

<div class="posts-list">
  {{- range $pages }}
  {{- $class := "post-entry" }}
  
  <article class="{{ $class }}">
    {{- $isHidden := (site.Params.cover.hidden | default site.Params.cover.hiddenInList) }}
    {{- partial "cover.html" (dict "cxt" . "IsHome" true "isHidden" $isHidden) }}
    <header class="entry-header">
      <h2>
        {{- .Title }}
        {{- if .Draft }}<sup><span class="entry-isdraft">&nbsp;&nbsp;[draft]</span></sup>{{- end }}
      </h2>
    </header>
    {{- if (ne (.Param "hideSummary") true) }}
    <div class="entry-content">
      <p>{{ .Summary | plainify | htmlUnescape }}{{ if .Truncated }}...{{ end }}</p>
    </div>
    {{- end }}
    {{- if not (.Param "hideMeta") }}
    <footer class="entry-footer">
      {{- partial "post_meta.html" . -}}
    </footer>
    {{- end }}
    <a class="entry-link" aria-label="post link to {{ .Title | plainify }}" href="{{ .Permalink }}"></a>
  </article>
  {{- end }}
</div>

<footer class="page-footer">
  <nav class="page-links">
    <a href="/tech/" class="section-link">View All Tech Posts →</a>
    <a href="/tutorials/" class="section-link">View All Tutorials →</a>
    <a href="/personal/" class="section-link">View All Personal Posts →</a>
  </nav>
</footer>

{{- end }}

{{- end }}{{/* end main */}}
